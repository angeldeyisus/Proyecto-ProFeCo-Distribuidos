generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Usuario {
  usuario_id    String      @id @default(uuid())
  email         String      @unique
  password_hash String
  nombre        String
  tipo_usuario  TipoUsuario
  multas        Multa[]
  tienda        Tienda?

  @@map("usuarios")
}

model Tienda {
  tienda_id  String   @id @default(uuid())
  usuario_id String   @unique
  nombre     String
  direccion  String?
  latitud    Decimal?
  longitud   Decimal?
  logo_url   String?
  multas     Multa[]
  usuario    Usuario  @relation(fields: [usuario_id], references: [usuario_id])

  @@map("tiendas")
}

model Multa {
  multa_id      String      @id @default(uuid())
  tienda_id     String
  fecha_emision DateTime    @default(now())
  motivo        String
  monto         Decimal
  estado        EstadoMulta @default(PENDIENTE)
  usuario_id    String?
  tienda        Tienda      @relation(fields: [tienda_id], references: [tienda_id])
  usuario       Usuario?    @relation(fields: [usuario_id], references: [usuario_id])

  @@map("multas")
}

enum TipoUsuario {
  CONSUMIDOR
  TIENDA
  PROFECO
}

enum EstadoMulta {
  PENDIENTE
  PAGADA
  APELADA
}
